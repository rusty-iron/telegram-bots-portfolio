"""
Keyboards for catalog functionality
"""

from aiogram.types import InlineKeyboardButton, InlineKeyboardMarkup


def get_catalog_products_keyboard(
    products: list, category_id: int, page: int = 0, per_page: int = 10
) -> InlineKeyboardMarkup:
    """–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π"""
    keyboard = []

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–≤–∞—Ä—ã –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    start_idx = page * per_page
    end_idx = start_idx + per_page
    page_products = products[start_idx:end_idx]

    for product in page_products:
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
        icon = "üì∏" if product.image_url else "ü•©"
        keyboard.append(
            [
                InlineKeyboardButton(
                    text=f"{icon} {product.name} - {product.price}‚ÇΩ",
                    callback_data=f"product_{product.id}",
                )
            ]
        )

    # –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    nav_buttons = []
    if page > 0:
        nav_buttons.append(
            InlineKeyboardButton(
                text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"category_{category_id}_page_{page - 1}",
            )
        )

    if end_idx < len(products):
        nav_buttons.append(
            InlineKeyboardButton(
                text="–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è",
                callback_data=f"category_{category_id}_page_{page + 1}",
            )
        )

    if nav_buttons:
        keyboard.append(nav_buttons)

    # –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞
    keyboard.append(
        [
            InlineKeyboardButton(
                text="üîô –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É", callback_data="catalog"
            )
        ]
    )

    return InlineKeyboardMarkup(inline_keyboard=keyboard)
